version: "3"
services:
  dashboard:
    image: cumulusdashboard:latest
    build:
      context: ../
      dockerfile: docker/Dockerfile
      args:
        APIROOT: 'http://localhost:5001'
        AUTH_METHOD: 'earthdata'
        AWS_REGION: 'us-east-1'
        DAAC_NAME: 'local'
        ESROOT: 'http://example.com'
        HIDE_PDR: 'false'
        SHOW_DISTRIBUTION_API_METRICS: 'true'
        SHOW_TEA_METRICS: 'false'
        STAGE: 'testing'
    depends_on:
      - serve_api
    network_mode: "service:shim"
    working_dir:
      /cumulus-dashboard
    environment:
      - PORT=3000
  shim:   # empty container to open ports
    image: alpine:latest
    command:
      tail -f /dev/null
    working_dir:
      /cumulus-dashboard
    ports:
      - "3000:3000"
